
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Webscrapping ESPNcricinfo &#8212; Dream11 Fantacy Sports ML Gamethon</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FIFS Sports Big Data Gamethon 2025" href="data-analysis.html" />
    <link rel="prev" title="Gamethon 2025" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Dream11 Fantacy Sports ML Gamethon - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="Dream11 Fantacy Sports ML Gamethon - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Gamethon 2025
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Webscrapping ESPNcricinfo</a></li>





<li class="toctree-l1"><a class="reference internal" href="data-analysis.html">FIFS Sports Big Data Gamethon 2025</a></li>





<li class="toctree-l1"><a class="reference internal" href="data-collection.html">Data collection</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/notebooks.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Webscrapping ESPNcricinfo</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Webscrapping ESPNcricinfo</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#espncricinfo-query">ESPNcricinfo query</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#query-structure">Query structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fetching-data-from-espncricinfo">Fetching data from ESPNcricinfo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-for-scraping-player-data">Documentation for Scraping Player Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modules-used">Modules Used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-overview">Process Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#batsmen">Batsmen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bowlers">Bowlers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fielders">Fielders</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data overview</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="webscrapping-espncricinfo">
<h1>Webscrapping ESPNcricinfo<a class="headerlink" href="#webscrapping-espncricinfo" title="Link to this heading">#</a></h1>
<p>I’m going to do web scraping of Website “<a class="reference external" href="https://www.espncricinfo.com/">https://www.espncricinfo.com/</a>” Page. ESPNcricinfo is a sports news website exclusively for the game of cricket. The site features news, articles, live coverage of cricket matches, and StatsGuru, a database of historical matches and players from the 18th century to the present.</p>
<p>First we Import all the Important Packages that are required to do Web Scraping.
Numpy and Pandas are standard and I always import it, who knows when it come handy.</p>
<ul class="simple">
<li><p>Request: It is a Python module that you can use to send all kinds of HTTP requests. It is an easy-to-use library with a lot of features ranging from passing parameters in URLs to sending custom headers and SSL Verification.</p></li>
<li><p>BeautifulSoup : It is a Python library for pulling data out of HTML and XML files. It works with your favorite parser to provide idiomatic ways of navigating, searching, and modifying the parse tree. It saves hours or days of work.</p></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="espncricinfo-query">
<h1>ESPNcricinfo query<a class="headerlink" href="#espncricinfo-query" title="Link to this heading">#</a></h1>
<p>Given that our target match involves the following teams:</p>
<ul class="simple">
<li><p>India</p></li>
<li><p>Pakistan</p></li>
<li><p>Bangladesh</p></li>
<li><p>New Zealand</p></li>
<li><p>England</p></li>
<li><p>Australia</p></li>
<li><p>Afghanistan</p></li>
<li><p>South Africa</p></li>
</ul>
<p>and will be held in <strong>Pakistan</strong> and <strong>Dubai</strong>, your query should be designed to extract data that is both team-specific and context-specific. Here’s what you should focus on:</p>
<ol class="arabic simple">
<li><p><strong>Team and Opposition Filters:</strong></p>
<ul class="simple">
<li><p><strong>Select Teams:</strong> Filter to include only matches involving the eight target teams.</p></li>
</ul>
</li>
<li><p><strong>Venue Filters:</strong></p>
<ul class="simple">
<li><p><strong>Home/Away:</strong> Filter for matches played in <strong>Pakistan</strong> and <strong>Dubai</strong>. This will allow you to capture how teams perform in these specific conditions (pitch behavior, weather, etc.).</p></li>
<li><p><strong>Ground:</strong> If needed, you could narrow it down further by selecting specific grounds in Pakistan or Dubai that are regularly used for ODIs.</p></li>
</ul>
</li>
<li><p><strong>Match Context Filters:</strong></p>
<ul class="simple">
<li><p><strong>Match Outcome &amp; Toss Result:</strong> Include filters for match outcomes and toss results, since these can affect team strategies and individual performances.</p></li>
<li><p><strong>Batting or Fielding First:</strong> Understanding whether teams batted or fielded first under these venues can be key to predicting performance.</p></li>
</ul>
</li>
<li><p><strong>Player and Performance Metrics:</strong></p>
<ul class="simple">
<li><p><strong>Key Batting Metrics:</strong> Runs scored, balls faced, strike rate, boundaries (fours &amp; sixes), batting position, and dismissal details.</p></li>
<li><p><strong>Bowling and Fielding Data:</strong> Wickets taken, overs bowled, economy rate, catches, run outs, and stumpings—since these contribute to the fantasy points.</p></li>
<li><p><strong>Role-Specific Data:</strong> If possible, identify player roles (batter, bowler, all-rounder, wicketkeeper) to ensure that team composition constraints are met.</p></li>
</ul>
</li>
<li><p><strong>Time Period:</strong></p>
<ul class="simple">
<li><p><strong>Recent Form:</strong> Emphasize data from recent seasons (e.g., last 5–10 years) to capture current form, but also consider historical performance if you need a larger sample size for more robust trends.</p></li>
</ul>
</li>
</ol>
<p>By querying for these data points, you’ll obtain a dataset that reflects both the <strong>performance metrics</strong> and <strong>contextual conditions</strong> specific to the teams and venues in question. This will be crucial for building a predictive model that can effectively optimize your fantasy team selection for the upcoming match.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip3<span class="w"> </span>install<span class="w"> </span>bs4<span class="w"> </span>numpy<span class="w"> </span>pandas<span class="w"> </span>-q
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> A new release of pip is available: <span class=" -Color -Color-Red">24.0</span> -&gt; <span class=" -Color -Color-Green">25.0</span>
<span class=" -Color -Color-Bold">[</span><span class=" -Color -Color-Blue">notice</span><span class=" -Color -Color-Bold">]</span> To update, run: <span class=" -Color -Color-Green">pip install --upgrade pip</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="query-structure">
<h1>Query structure<a class="headerlink" href="#query-structure" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bs4</span><span class="w"> </span><span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TEAM_CODES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;India&quot;</span><span class="p">:</span> <span class="s2">&quot;6&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Pakistan&quot;</span><span class="p">:</span> <span class="s2">&quot;7&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Bangladesh&quot;</span><span class="p">:</span> <span class="s2">&quot;25&quot;</span><span class="p">,</span>
    <span class="s2">&quot;New Zealand&quot;</span><span class="p">:</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span>
    <span class="s2">&quot;England&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Australia&quot;</span><span class="p">:</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Afghanistan&quot;</span><span class="p">:</span> <span class="s2">&quot;40&quot;</span><span class="p">,</span>
    <span class="s2">&quot;South Africa&quot;</span><span class="p">:</span> <span class="s2">&quot;3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s2">&quot;https://stats.espncricinfo.com/ci/engine/stats/index.html&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TIME_SPANS</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2024</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">month</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="n">year</span><span class="p">,</span> <span class="n">month</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">start_date_str</span> <span class="o">=</span> <span class="n">start_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">)</span>
        <span class="n">end_date_str</span> <span class="o">=</span> <span class="n">end_date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">)</span>
        
        <span class="n">TIME_SPANS</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">start_date_str</span><span class="p">,</span> <span class="n">end_date_str</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># COmment out these lines when you are ready to scrape all data</span>
<span class="c1"># and adjust the time in above cells</span>

<span class="n">TIME_SPANS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;01+Jan+2014&quot;</span><span class="p">,</span> <span class="s2">&quot;01+Jan+2015&quot;</span><span class="p">),</span>  <span class="c1"># from 1 Jan 2014 to 1 Jan 2015</span>
    <span class="c1"># (&quot;01+Jan+2015&quot;, &quot;01+Jan+2016&quot;),  # from 1 Jan 2015 to 1 Jan 2016</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TIME_SPANS</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;01+Jan+2014&#39;, &#39;01+Jan+2015&#39;)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">TIME_SPANS</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example URL response:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://stats.espncricinfo.com/ci/engine/stats/index.html?class=2;filter=advanced;orderby=runs;spanmin1=01+Jan+2014;spanmax1=01+Jan+2015;spanval1=span;team=6;template=results;type=batting&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;
&lt;!-- hostname: web06, edition-view: , country: unknown, cluster: www, created: 2025-02-02 12:53:44 --&gt;
&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot; xmlns:fb=&quot;http://www.facebook.com/2008/fbml&quot; xmlns:og=&quot;http://opengraphprotocol.org/schema/&quot; xmlns:fb=&quot;http://developers.facebook.com/schema/&quot; &gt;
&lt;head&gt;
 &lt;script type=&quot;text/javascript&quot;&gt;var _sf_startpt=(new Date()).getTime()&lt;/script&gt;
 &lt;meta name=&quot;google-site-verification&quot; content=&quot;ZxdgH3XglRg0Bsy-Ho2RnO3EE4nRs53FloLS6fkt_nc&quot; /&gt;
 &lt;meta
        name=&quot;viewport&quot;
        content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0&quot;
      /&gt;
 &lt;title&gt;Batting records | One-Day Internationals | Cricinfo Statsguru | ESPNcricinfo.com&lt;/title&gt;
 &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot; /&gt;
 &lt;meta name=&quot;keywords&quot; content=&quot;&quot; /&gt;

 
 &lt;meta name=&quot;description&quot; content=&quot;&quot; /&gt;
&lt;!--[if IE 9]&gt;
&lt;script l
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fetching-data-from-espncricinfo">
<h1>Fetching data from ESPNcricinfo<a class="headerlink" href="#fetching-data-from-espncricinfo" title="Link to this heading">#</a></h1>
<section id="documentation-for-scraping-player-data">
<h2>Documentation for Scraping Player Data<a class="headerlink" href="#documentation-for-scraping-player-data" title="Link to this heading">#</a></h2>
<p>This script is used to scrape player statistics for required cricket teams over a given period from ESPN Cricinfo’s Stats Engine. It fetches the batting statistics of players from different teams within specific time spans and organizes the data into a structured format for analysis.</p>
<hr class="docutils" />
<section id="modules-used">
<h3>Modules Used<a class="headerlink" href="#modules-used" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>requests</strong>: To send HTTP requests and fetch the web page.</p></li>
<li><p><strong>BeautifulSoup</strong> (from <code class="docutils literal notranslate"><span class="pre">bs4</span></code>): To parse HTML and extract data.</p></li>
<li><p><strong>pandas</strong>: To structure the extracted data into DataFrames.</p></li>
<li><p><strong>numpy</strong>: To handle missing values and manage numerical operations.</p></li>
<li><p><strong>datetime</strong>: To generate the required time spans for the scraping process.</p></li>
</ul>
<hr class="docutils" />
</section>
</section>
<section id="constants">
<h2>Constants<a class="headerlink" href="#constants" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>TEAM_CODES</strong>: A dictionary mapping cricket team names to their respective team codes used in the URL query string.</p></li>
<li><p><strong>BASE_URL</strong>: The base URL for the ESPN Cricinfo stats engine to fetch player data.</p></li>
<li><p><strong>TIME_SPANS</strong>: A list of tuples representing the time periods (start and end dates) for which player data is fetched. This is generated for every year from 2010 to 2023.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="process-overview">
<h2>Process Overview<a class="headerlink" href="#process-overview" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Setting Up Time Periods</strong>:</p>
<ul class="simple">
<li><p>The script generates monthly time spans (from January 2010 to December 2023) by iterating through each year and month, and storing them in the <code class="docutils literal notranslate"><span class="pre">TIME_SPANS</span></code> list.</p></li>
</ul>
</li>
<li><p><strong>Headers for Request</strong>:</p>
<ul class="simple">
<li><p>A <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code> header is used in the requests to mimic a request from a real browser, which is required for bypassing restrictions set by the website.</p></li>
</ul>
</li>
<li><p><strong>Fetching Data</strong>:</p>
<ul class="simple">
<li><p>The main part of the script involves constructing a URL for each team and time period using the <code class="docutils literal notranslate"><span class="pre">TEAM_CODES</span></code> and <code class="docutils literal notranslate"><span class="pre">TIME_SPANS</span></code> lists.</p></li>
<li><p>The URL is constructed with parameters like:</p>
<ul>
<li><p>Class type (<code class="docutils literal notranslate"><span class="pre">class=2</span></code> for batting),</p></li>
<li><p>Time period (<code class="docutils literal notranslate"><span class="pre">spanmin1</span></code>, <code class="docutils literal notranslate"><span class="pre">spanmax1</span></code> for the start and end dates),</p></li>
<li><p>Team code (<code class="docutils literal notranslate"><span class="pre">team</span></code> for the specific team),</p></li>
<li><p>Ordering parameter (<code class="docutils literal notranslate"><span class="pre">orderby=runs</span></code>),</p></li>
<li><p>Filter type (<code class="docutils literal notranslate"><span class="pre">filter=advanced</span></code>).</p></li>
</ul>
</li>
<li><p>The script then sends an HTTP request to the URL and checks for a successful response (status code 200).</p></li>
</ul>
</li>
<li><p><strong>Extracting Player Data</strong>:</p>
<ul class="simple">
<li><p>Once the HTML response is received, the <code class="docutils literal notranslate"><span class="pre">extract_player_data()</span></code> function is called to parse the data:</p>
<ul>
<li><p>The function uses BeautifulSoup to search for tables with the class <code class="docutils literal notranslate"><span class="pre">engineTable</span></code>, which contain the player statistics.</p></li>
<li><p>It looks for the table with the caption “Overall figures” and extracts the player stats from the table rows.</p></li>
<li><p>If no such table is found, the function returns an empty DataFrame.</p></li>
</ul>
</li>
<li><p>Extracted player data is structured into a pandas DataFrame.</p></li>
</ul>
</li>
<li><p><strong>Storing Data</strong>:</p>
<ul class="simple">
<li><p>Data for each team and time period is appended to a global DataFrame <code class="docutils literal notranslate"><span class="pre">detailed_player_stats_bat</span></code>.</p></li>
<li><p>The data includes columns like “Mat” (matches), “Inns” (innings), “Runs”, “100” (centuries), and more.</p></li>
</ul>
</li>
<li><p><strong>Post-Processing</strong>:</p>
<ul class="simple">
<li><p>Missing values (represented as <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code>) are replaced with NaN using <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p></li>
<li><p>Certain columns like “HS” (highest score), “Mat” (matches), and “Runs” are cleaned and converted to the appropriate data types.</p></li>
<li><p>Date columns “Start Date” and “End Date” are converted to pandas <code class="docutils literal notranslate"><span class="pre">datetime</span></code> format for easy analysis.</p></li>
</ul>
</li>
<li><p><strong>Final Output</strong>:</p>
<ul class="simple">
<li><p>The script prints the total number of teams fetched and not fetched.</p></li>
<li><p>If no data is extracted for a particular time span and team, it is logged for reference.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_player_data</span><span class="p">(</span><span class="n">html_response</span><span class="p">):</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_response</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;engineTable&quot;</span><span class="p">})</span>
    <span class="n">target_table</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="c1"># Find the table with the caption &quot;Overall figures&quot;</span>
    <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
        <span class="n">caption</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;caption&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">caption</span> <span class="ow">and</span> <span class="n">caption</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;overall figures&quot;</span><span class="p">:</span>
            <span class="n">target_table</span> <span class="o">=</span> <span class="n">table</span>
            <span class="k">break</span>
    
    <span class="c1"># If no table is found, return an empty DataFrame</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">target_table</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="c1"># Extract headers from the table</span>
    <span class="n">thead</span> <span class="o">=</span> <span class="n">target_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;thead&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">thead</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="n">th</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">th</span> <span class="ow">in</span> <span class="n">thead</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">)]</span>

    <span class="c1"># Extract rows from the table</span>
    <span class="n">tbody</span> <span class="o">=</span> <span class="n">target_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">tbody</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">tbody</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;data1&quot;</span><span class="p">}):</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">)</span>
        <span class="n">row_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">cell</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">cells</span><span class="p">]</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Create and return a DataFrame</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="batsmen">
<h2>Batsmen<a class="headerlink" href="#batsmen" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://stats.espncricinfo.com/ci/engine/stats/index.html?class=2;filter=advanced;orderby=runs;spanmin1=01+Jan+2014;spanmax1=01+Jan+2015;spanval1=span;team=6;template=results;type=batting&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">player_data</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">player_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">player_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data extracted.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Player Mat Inns NO  Runs    HS    Ave    BF     SR 100 50  0  4s  6s  
0    V Kohli  21   20  2  1054  139*  58.55  1058  99.62   4  5  1  94  20  
1   S Dhawan  18   18  1   815   113  47.94   942  86.51   1  6  0  90  14  
2  AM Rahane  24   24  0   768   111  32.00   945  81.26   2  4  2  82  10  
3  AT Rayudu  20   18  5   584  121*  44.92   727  80.33   1  4  0  49  11  
4  RG Sharma  12   12  1   578   264  52.54   613  94.29   1  3  0  58  22  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_bat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">teams_fetched</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">teams_not_fetched</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Webscraping started!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total iterations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">TIME_SPANS</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">TEAM_CODES</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span> <span class="ow">in</span> <span class="n">TIME_SPANS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">team_name</span><span class="p">,</span> <span class="n">team_code</span> <span class="ow">in</span> <span class="n">TEAM_CODES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">filter_params</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span> <span class="s2">&quot;advanced&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;orderby&quot;</span><span class="p">,</span> <span class="s2">&quot;runs&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmin1&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmax1&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanval1&quot;</span><span class="p">,</span> <span class="s2">&quot;span&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">,</span> <span class="n">team_code</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;batting&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">player_data</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">player_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_name</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_date</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_date</span>
                <span class="n">detailed_player_stats_bat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">detailed_player_stats_bat</span><span class="p">,</span> <span class="n">player_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">teams_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># print(f&quot;No data extracted for {team_name} from {start_date} to {end_date}&quot;)</span>
                <span class="n">teams_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch data for </span><span class="si">{</span><span class="n">team_name</span><span class="si">}</span><span class="s2"> (Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">teams_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>


<span class="n">detailed_player_stats_bat</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">if</span> <span class="s2">&quot;HS&quot;</span> <span class="ow">in</span> <span class="n">detailed_player_stats_bat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;HS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;HS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
    <span class="p">)</span>

<span class="c1"># Convert integer columns</span>
<span class="n">int_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mat&quot;</span><span class="p">,</span> <span class="s2">&quot;Inns&quot;</span><span class="p">,</span> <span class="s2">&quot;NO&quot;</span><span class="p">,</span> <span class="s2">&quot;Runs&quot;</span><span class="p">,</span> <span class="s2">&quot;BF&quot;</span><span class="p">,</span> <span class="s2">&quot;100&quot;</span><span class="p">,</span> <span class="s2">&quot;50&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;4s&quot;</span><span class="p">,</span> <span class="s2">&quot;6s&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">int_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_bat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Convert float columns</span>
<span class="n">float_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ave&quot;</span><span class="p">,</span> <span class="s2">&quot;SR&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">float_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_bat</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="p">)</span>

<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Web scraping completed!&quot;</span><span class="p">)</span>

<span class="c1"># </span>
<span class="c1"># Summary</span>
<span class="c1"># </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total teams fetched: </span><span class="si">{</span><span class="n">teams_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total teams not fetched: </span><span class="si">{</span><span class="n">teams_not_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Webscraping started!
Total iterations: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 

Web scraping completed!

Total teams fetched: 8
Total teams not fetched: 0
</pre></div>
</div>
</div>
</div>
</section>
<section id="bowlers">
<h2>Bowlers<a class="headerlink" href="#bowlers" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://stats.espncricinfo.com/ci/engine/stats/index.html?class=2;filter=advanced;orderby=wickets;spanmin1=01+Jan+2014;spanmax1=01+Jan+2015;spanval1=span;team=6;template=results;type=bowling&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">player_data_bowl</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">player_data_bowl</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">player_data_bowl</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data extracted.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           Player Mat Inns  Overs Mdns Runs Wkts   BBI    Ave  Econ    SR  4  \
0  Mohammed Shami  16   16  141.3    6  872   38  4/36  22.94  6.16  22.3  4   
1       RA Jadeja  17   17  160.0    6  817   25  4/28  32.68  5.10  38.4  2   
2        R Ashwin  17   17  161.5    8  768   23  3/31  33.39  4.74  42.2  0   
3        UT Yadav  10    9   71.2    3  381   17  4/53  22.41  5.34  25.1  1   
4         B Kumar  16   16  137.2   10  635   14  2/14  45.35  4.62  58.8  0   

   5    
0  0    
1  0    
2  0    
3  0    
4  0    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_bowl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total_fetched</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total_not_fetched</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Web scraping started!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total iterations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">TIME_SPANS</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">TEAM_CODES</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span> <span class="ow">in</span> <span class="n">TIME_SPANS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">team_name</span><span class="p">,</span> <span class="n">team_code</span> <span class="ow">in</span> <span class="n">TEAM_CODES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">filter_params</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span> <span class="s2">&quot;advanced&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;orderby&quot;</span><span class="p">,</span> <span class="s2">&quot;wickets&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmin1&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmax1&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanval1&quot;</span><span class="p">,</span> <span class="s2">&quot;span&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">,</span> <span class="n">team_code</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;bowling&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">player_data</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">player_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_name</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_date</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_date</span>
                <span class="n">detailed_player_stats_bowl</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">detailed_player_stats_bowl</span><span class="p">,</span> <span class="n">player_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">total_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">total_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch data for </span><span class="si">{</span><span class="n">team_name</span><span class="si">}</span><span class="s2"> (Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">total_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

<span class="c1"># Data Cleaning &amp; Type Conversion</span>
<span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">int_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mat&quot;</span><span class="p">,</span> <span class="s2">&quot;Inns&quot;</span><span class="p">,</span> <span class="s2">&quot;Mdns&quot;</span><span class="p">,</span> <span class="s2">&quot;Runs&quot;</span><span class="p">,</span> <span class="s2">&quot;Wkts&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">int_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>

<span class="n">float_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Ave&quot;</span><span class="p">,</span> <span class="s2">&quot;Econ&quot;</span><span class="p">,</span> <span class="s2">&quot;SR&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">float_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>

<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Web scraping completed!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total teams fetched: </span><span class="si">{</span><span class="n">total_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total teams not fetched: </span><span class="si">{</span><span class="n">total_not_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Web scraping started!
Total iterations: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 

Web scraping completed!

Total teams fetched: 8
Total teams not fetched: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 192 entries, 0 to 191
Data columns (total 17 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   Player      192 non-null    object        
 1   Mat         192 non-null    Int64         
 2   Inns        139 non-null    Int64         
 3   Overs       139 non-null    object        
 4   Mdns        139 non-null    Int64         
 5   Runs        139 non-null    Int64         
 6   Wkts        139 non-null    Int64         
 7   BBI         117 non-null    object        
 8   Ave         117 non-null    float64       
 9   Econ        138 non-null    float64       
 10  SR          117 non-null    float64       
 11  4           139 non-null    Int64         
 12  5           139 non-null    Int64         
 13              192 non-null    object        
 14  Team        192 non-null    object        
 15  Start Date  192 non-null    datetime64[ns]
 16  End Date    192 non-null    datetime64[ns]
dtypes: Int64(7), datetime64[ns](2), float64(3), object(5)
memory usage: 26.9+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Player</th>
      <th>Mat</th>
      <th>Inns</th>
      <th>Overs</th>
      <th>Mdns</th>
      <th>Runs</th>
      <th>Wkts</th>
      <th>BBI</th>
      <th>Ave</th>
      <th>Econ</th>
      <th>SR</th>
      <th>4</th>
      <th>5</th>
      <th></th>
      <th>Team</th>
      <th>Start Date</th>
      <th>End Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mohammed Shami</td>
      <td>16</td>
      <td>16</td>
      <td>141.3</td>
      <td>6</td>
      <td>872</td>
      <td>38</td>
      <td>4/36</td>
      <td>22.94</td>
      <td>6.16</td>
      <td>22.3</td>
      <td>4</td>
      <td>0</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RA Jadeja</td>
      <td>17</td>
      <td>17</td>
      <td>160.0</td>
      <td>6</td>
      <td>817</td>
      <td>25</td>
      <td>4/28</td>
      <td>32.68</td>
      <td>5.10</td>
      <td>38.4</td>
      <td>2</td>
      <td>0</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R Ashwin</td>
      <td>17</td>
      <td>17</td>
      <td>161.5</td>
      <td>8</td>
      <td>768</td>
      <td>23</td>
      <td>3/31</td>
      <td>33.39</td>
      <td>4.74</td>
      <td>42.2</td>
      <td>0</td>
      <td>0</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>UT Yadav</td>
      <td>10</td>
      <td>9</td>
      <td>71.2</td>
      <td>3</td>
      <td>381</td>
      <td>17</td>
      <td>4/53</td>
      <td>22.41</td>
      <td>5.34</td>
      <td>25.1</td>
      <td>1</td>
      <td>0</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B Kumar</td>
      <td>16</td>
      <td>16</td>
      <td>137.2</td>
      <td>10</td>
      <td>635</td>
      <td>14</td>
      <td>2/14</td>
      <td>45.35</td>
      <td>4.62</td>
      <td>58.8</td>
      <td>0</td>
      <td>0</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="fielders">
<h2>Fielders<a class="headerlink" href="#fielders" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example Usage:</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="s2">&quot;https://stats.espncricinfo.com/ci/engine/stats/index.html?class=2;filter=advanced;orderby=runs;spanmin1=01+Jan+2014;spanmax1=01+Jan+2015;spanval1=span;team=6;template=results;type=fielding&quot;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="s2">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36&quot;</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">fielder_data</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">fielder_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">fielder_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No data extracted.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      Player Mat Inns Dis  Ct St Ct Wk Ct Fi           MD    D/I  
0  AM Rahane  24   23  16  16  0     0    16  2 (2ct 0st)  0.695  
1   MS Dhoni  12   12  13   7  6     7     0  4 (2ct 2st)  1.083  
2    WP Saha   6    5  12  11  1    11     0  4 (4ct 0st)  2.400  
3   S Dhawan  18   18   9   9  0     0     9  2 (2ct 0st)  0.500  
4   SK Raina  17   16   9   9  0     0     9  2 (2ct 0st)  0.562  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_field</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">teams_fetched</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">teams_not_fetched</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Webscraping started!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total iterations: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">TIME_SPANS</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">TEAM_CODES</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span> <span class="ow">in</span> <span class="n">TIME_SPANS</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">team_name</span><span class="p">,</span> <span class="n">team_code</span> <span class="ow">in</span> <span class="n">TEAM_CODES</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">filter_params</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;filter&quot;</span><span class="p">,</span> <span class="s2">&quot;advanced&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;orderby&quot;</span><span class="p">,</span> <span class="s2">&quot;runs&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmin1&quot;</span><span class="p">,</span> <span class="n">start_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanmax1&quot;</span><span class="p">,</span> <span class="n">end_date</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;spanval1&quot;</span><span class="p">,</span> <span class="s2">&quot;span&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;team&quot;</span><span class="p">,</span> <span class="n">team_code</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;template&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;fielding&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">query_string</span> <span class="o">=</span> <span class="s2">&quot;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">filter_params</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_URL</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="n">query_string</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">player_data</span> <span class="o">=</span> <span class="n">extract_player_data</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">player_data</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Team&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">team_name</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_date</span>
                <span class="n">player_data</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_date</span>
                <span class="n">detailed_player_stats_field</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">detailed_player_stats_field</span><span class="p">,</span> <span class="n">player_data</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">teams_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># print(f&quot;No data extracted for {team_name} from {start_date} to {end_date}&quot;)</span>
                <span class="n">teams_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fetch data for </span><span class="si">{</span><span class="n">team_name</span><span class="si">}</span><span class="s2"> (Status code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">teams_not_fetched</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)</span>


<span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Convert integer columns</span>
<span class="n">int_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mat&quot;</span><span class="p">,</span> <span class="s2">&quot;Inns&quot;</span><span class="p">,</span> <span class="s2">&quot;Dis&quot;</span><span class="p">,</span> <span class="s2">&quot;Ct&quot;</span><span class="p">,</span> <span class="s2">&quot;St&quot;</span><span class="p">,</span> <span class="s2">&quot;Wk&quot;</span><span class="p">,</span> <span class="s2">&quot;Fi&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">int_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;Int64&quot;</span><span class="p">)</span>
        <span class="p">)</span>

<span class="c1"># Convert float columns</span>
<span class="n">float_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;D/I&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">float_columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="p">)</span>

<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s2">&quot;Start Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>
<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s2">&quot;End Date&quot;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">+%b+%Y&quot;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&quot;coerce&quot;</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Web scraping completed!&quot;</span><span class="p">)</span>

<span class="c1"># </span>
<span class="c1"># Summary</span>
<span class="c1"># </span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total teams fetched: </span><span class="si">{</span><span class="n">teams_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total teams not fetched: </span><span class="si">{</span><span class="n">teams_not_fetched</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Webscraping started!
Total iterations: 8
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7 
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 

Web scraping completed!

Total teams fetched: 8
Total teams not fetched: 0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 192 entries, 0 to 191
Data columns (total 14 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   Player      192 non-null    object        
 1   Mat         192 non-null    Int64         
 2   Inns        191 non-null    Int64         
 3   Dis         191 non-null    Int64         
 4   Ct          191 non-null    Int64         
 5   St          191 non-null    Int64         
 6   Ct Wk       191 non-null    object        
 7   Ct Fi       191 non-null    object        
 8   MD          191 non-null    object        
 9   D/I         191 non-null    float64       
 10              192 non-null    object        
 11  Team        192 non-null    object        
 12  Start Date  192 non-null    datetime64[ns]
 13  End Date    192 non-null    datetime64[ns]
dtypes: Int64(5), datetime64[ns](2), float64(1), object(6)
memory usage: 22.1+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Player</th>
      <th>Mat</th>
      <th>Inns</th>
      <th>Dis</th>
      <th>Ct</th>
      <th>St</th>
      <th>Ct Wk</th>
      <th>Ct Fi</th>
      <th>MD</th>
      <th>D/I</th>
      <th></th>
      <th>Team</th>
      <th>Start Date</th>
      <th>End Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AM Rahane</td>
      <td>24</td>
      <td>23</td>
      <td>16</td>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>16</td>
      <td>2 (2ct 0st)</td>
      <td>0.695</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MS Dhoni</td>
      <td>12</td>
      <td>12</td>
      <td>13</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>4 (2ct 2st)</td>
      <td>1.083</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WP Saha</td>
      <td>6</td>
      <td>5</td>
      <td>12</td>
      <td>11</td>
      <td>1</td>
      <td>11</td>
      <td>0</td>
      <td>4 (4ct 0st)</td>
      <td>2.400</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S Dhawan</td>
      <td>18</td>
      <td>18</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2 (2ct 0st)</td>
      <td>0.500</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>SK Raina</td>
      <td>17</td>
      <td>16</td>
      <td>9</td>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>2 (2ct 0st)</td>
      <td>0.562</td>
      <td></td>
      <td>India</td>
      <td>2014-01-01</td>
      <td>2015-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-overview">
<h1>Data overview<a class="headerlink" href="#data-overview" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;seaborn&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">detailed_player_stats_bat</span><span class="p">[[</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;Ave&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="s1">&#39;50&#39;</span><span class="p">,</span> <span class="s1">&#39;4s&#39;</span><span class="p">,</span> <span class="s1">&#39;6s&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap of Player Performance Metrics&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/854a3a090d67c79f14f75032c999dd392dba35f415ab304f1edfc0145559ec9e.png" src="_images/854a3a090d67c79f14f75032c999dd392dba35f415ab304f1edfc0145559ec9e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">detailed_player_stats_bowl</span><span class="p">[[</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;Wkts&#39;</span><span class="p">,</span> <span class="s1">&#39;Ave&#39;</span><span class="p">,</span> <span class="s1">&#39;Econ&#39;</span><span class="p">,</span> <span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap of Player Bowling Metrics&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/083ae4c6c82d4cce90a753490d4a05b784196cab17adee3aa7ca493aaffb4c0c.png" src="_images/083ae4c6c82d4cce90a753490d4a05b784196cab17adee3aa7ca493aaffb4c0c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">detailed_player_stats_field</span><span class="p">[[</span><span class="s1">&#39;Dis&#39;</span><span class="p">,</span> <span class="s1">&#39;Ct&#39;</span><span class="p">,</span> <span class="s1">&#39;St&#39;</span><span class="p">,</span> <span class="s1">&#39;Ct Wk&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Correlation Heatmap of Player Fielding Metrics&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ffcd99a1f646e370e35a6ce771b8f6ec06635ecbf2c6886437b16482e0c7f8fc.png" src="_images/ffcd99a1f646e370e35a6ce771b8f6ec06635ecbf2c6886437b16482e0c7f8fc.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="history">
<h1>History<a class="headerlink" href="#history" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">batting_players</span> <span class="o">=</span> <span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">bowling_players</span> <span class="o">=</span> <span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">fielding_players</span> <span class="o">=</span> <span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="n">ODIplayers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">batting_players</span><span class="p">,</span> <span class="n">bowling_players</span><span class="p">,</span> <span class="n">fielding_players</span><span class="p">]))</span>

<span class="nb">len</span><span class="p">(</span><span class="n">ODIplayers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>192
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ODIplayers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;A Mishra&#39;, &#39;AB de Villiers&#39;, &#39;AD Hales&#39;, &#39;AF Milne&#39;, &#39;AJ Finch&#39;,
       &#39;AM Phangiso&#39;, &#39;AM Rahane&#39;, &#39;AN Cook&#39;, &#39;AP Devcich&#39;, &#39;AR Patel&#39;,
       &#39;AT Rayudu&#39;, &#39;Abdur Razzak&#39;, &#39;Abdur Rehman&#39;, &#39;Abul Hasan&#39;,
       &#39;Afsar Zazai&#39;, &#39;Aftab Alam&#39;, &#39;Ahmed Shehzad&#39;, &#39;Al-Amin Hossain&#39;,
       &#39;Amir Hamza&#39;, &#39;Anamul Haque&#39;, &#39;Anwar Ali&#39;, &#39;Arafat Sunny&#39;,
       &#39;Asad Shafiq&#39;, &#39;Asghar Afghan&#39;, &#39;B Kumar&#39;, &#39;BA Stokes&#39;,
       &#39;BB McCullum&#39;, &#39;BCJ Cutting&#39;, &#39;BJ Haddin&#39;, &#39;Bilawal Bhatti&#39;,
       &#39;CA Pujara&#39;, &#39;CJ Anderson&#39;, &#39;CJ Jordan&#39;, &#39;CJ McKay&#39;, &#39;CR Woakes&#39;,
       &#39;DA Miller&#39;, &#39;DA Warner&#39;, &#39;DG Brownlie&#39;, &#39;DL Vettori&#39;,
       &#39;DS Kulkarni&#39;, &#39;DT Christian&#39;, &#39;DW Steyn&#39;, &#39;Dawlat Zadran&#39;,
       &#39;EJG Morgan&#39;, &#39;F Behardien&#39;, &#39;F du Plessis&#39;, &#39;Fareed Ahmad&#39;,
       &#39;Fawad Alam&#39;, &#39;GJ Bailey&#39;, &#39;GJ Maxwell&#39;, &#39;GS Ballance&#39;,
       &#39;Gulbadin Naib&#39;, &#39;HF Gurney&#39;, &#39;HK Bennett&#39;, &#39;HM Amla&#39;,
       &#39;Hamid Hassan&#39;, &#39;Haris Sohail&#39;, &#39;Hashmatullah Shahidi&#39;, &#39;I Sharma&#39;,
       &#39;IR Bell&#39;, &#39;Imran Tahir&#39;, &#39;Imrul Kayes&#39;, &#39;JC Buttler&#39;,
       &#39;JC Tredwell&#39;, &#39;JD Ryder&#39;, &#39;JDS Neesham&#39;, &#39;JE Root&#39;, &#39;JH Kallis&#39;,
       &#39;JL Pattinson&#39;, &#39;JM Anderson&#39;, &#39;JP Duminy&#39;, &#39;JP Faulkner&#39;,
       &#39;JR Hazlewood&#39;, &#39;JWA Taylor&#39;, &#39;Javed Ahmadi&#39;, &#39;Jubair Hossain&#39;,
       &#39;Junaid Khan&#39;, &#39;KD Karthik&#39;, &#39;KD Mills&#39;, &#39;KJ Abbott&#39;, &#39;KM Jadhav&#39;,
       &#39;KS Williamson&#39;, &#39;KV Sharma&#39;, &#39;KW Richardson&#39;, &#39;Karim Sadiq&#39;,
       &#39;L Ronchi&#39;, &#39;LJ Wright&#39;, &#39;LRPL Taylor&#39;, &#39;M Morkel&#39;, &#39;M Shezi&#39;,
       &#39;M de Lange&#39;, &#39;MA Carberry&#39;, &#39;MA Starc&#39;, &#39;MG Johnson&#39;, &#39;MJ Clarke&#39;,
       &#39;MJ Guptill&#39;, &#39;MJ Henry&#39;, &#39;MJ Lumb&#39;, &#39;MJ McClenaghan&#39;, &#39;MK Tiwary&#39;,
       &#39;MM Ali&#39;, &#39;MM Sharma&#39;, &#39;MR Marsh&#39;, &#39;MS Dhoni&#39;, &#39;MS Wade&#39;,
       &#39;Mahmudullah&#39;, &#39;Mashrafe Mortaza&#39;, &#39;Mirwais Ashraf&#39;,
       &#39;Misbah-ul-Haq&#39;, &#39;Mohammad Hafeez&#39;, &#39;Mohammad Irfan&#39;,
       &#39;Mohammad Mithun&#39;, &#39;Mohammad Nabi&#39;, &#39;Mohammad Shahzad&#39;,
       &#39;Mohammad Talha&#39;, &#39;Mohammed Shami&#39;, &#39;Mominul Haque&#39;,
       &#39;Mushfiqur Rahim&#39;, &#39;NL McCullum&#39;, &#39;NM Coulter-Nile&#39;, &#39;NM Lyon&#39;,
       &#39;Naeem Islam&#39;, &#39;Najibullah Zadran&#39;, &#39;Nasir Hossain&#39;, &#39;Nasir Jamal&#39;,
       &#39;Nasir Jamshed&#39;, &#39;Nawroz Mangal&#39;, &#39;Noor Ali Zadran&#39;, &#39;PJ Cummins&#39;,
       &#39;PJ Hughes&#39;, &#39;Parvez Rasool&#39;, &#39;Q de Kock&#39;, &#39;R Ashwin&#39;, &#39;R McLaren&#39;,
       &#39;RA Jadeja&#39;, &#39;RG Sharma&#39;, &#39;RJ Peterson&#39;, &#39;RR Rossouw&#39;, &#39;RS Bopara&#39;,
       &#39;RV Uthappa&#39;, &#39;Rahmat Shah&#39;, &#39;Raza Hasan&#39;, &#39;Rubel Hossain&#39;,
       &#39;S Dhawan&#39;, &#39;SA Abbott&#39;, &#39;SCJ Broad&#39;, &#39;SD Parry&#39;, &#39;SE Marsh&#39;,
       &#39;SK Raina&#39;, &#39;SPD Smith&#39;, &#39;SR Watson&#39;, &#39;ST Finn&#39;, &#39;STR Binny&#39;,
       &#39;Sabbir Rahman&#39;, &#39;Saeed Ajmal&#39;, &#39;Samiullah Shinwari&#39;,
       &#39;Sarfaraz Ahmed&#39;, &#39;Shafiqullah&#39;, &#39;Shafiul Islam&#39;, &#39;Shahid Afridi&#39;,
       &#39;Shakib Al Hasan&#39;, &#39;Shamsur Rahman&#39;, &#39;Shapoor Zadran&#39;,
       &#39;Sharafuddin Ashraf&#39;, &#39;Sharjeel Khan&#39;, &#39;Sohag Gazi&#39;,
       &#39;Sohaib Maqsood&#39;, &#39;Sohail Tanvir&#39;, &#39;Soumya Sarkar&#39;, &#39;TA Boult&#39;,
       &#39;TG Southee&#39;, &#39;TT Bresnan&#39;, &#39;TWM Latham&#39;, &#39;Taijul Islam&#39;,
       &#39;Tamim Iqbal&#39;, &#39;Taskin Ahmed&#39;, &#39;UT Yadav&#39;, &#39;Umar Akmal&#39;,
       &#39;Umar Amin&#39;, &#39;Umar Gul&#39;, &#39;Usman Ghani&#39;, &#39;V Kohli&#39;, &#39;VD Philander&#39;,
       &#39;VR Aaron&#39;, &#39;WB Rankin&#39;, &#39;WD Parnell&#39;, &#39;WP Saha&#39;, &#39;Wahab Riaz&#39;,
       &#39;XJ Doherty&#39;, &#39;Younis Khan&#39;, &#39;Ziaur Rahman&#39;, &#39;Zulfiqar Babar&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure all columns are numeric where needed</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;Runs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;Runs&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;SR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;SR&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;6s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;6s&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;4s&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;4s&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bat</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Runs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Runs&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Wkts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Wkts&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Econ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;Econ&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;SR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;SR&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;4&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_bowl</span><span class="p">[</span><span class="s1">&#39;5&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Dis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Dis&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Ct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Ct&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;St&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Ct Wk&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;Ct Wk&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
<span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">detailed_player_stats_field</span><span class="p">[</span><span class="s1">&#39;MD&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="c1"># Re-run the aggregation</span>
<span class="n">player_stats_bat_summary</span> <span class="o">=</span> <span class="n">detailed_player_stats_bat</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">average_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_strike_rate</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_strike_rate</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_strike_rate</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_6s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;6s&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_6s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;6s&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_6s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;6s&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_4s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4s&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_4s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4s&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_4s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4s&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_0s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_0s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_0s</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">player_stats_bowl_summary</span> <span class="o">=</span> <span class="n">detailed_player_stats_bowl</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">average_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_runs</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Runs&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_wickets</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Wkts&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_wickets</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Wkts&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_wickets</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Wkts&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_eco</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Econ&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_eco</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Econ&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_eco</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Econ&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_sr</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_sr</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_sr</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_4w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_4w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_4w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_5w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_5w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_5w</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">player_stats_field_summary</span> <span class="o">=</span> <span class="n">detailed_player_stats_field</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Player&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span>
    <span class="n">average_dis</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Dis&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_dis</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Dis&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_dis</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Dis&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_ct</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_ct</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_ct</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_st</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;St&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_st</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;St&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_st</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;St&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_ct_wk</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct Wk&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_ct_wk</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct Wk&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_ct_wk</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Ct Wk&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">),</span>
    <span class="n">average_md</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">),</span>
    <span class="n">max_md</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">),</span>
    <span class="n">min_md</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;MD&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Merge summaries</span>
<span class="n">player_stats_summary</span> <span class="o">=</span> <span class="n">player_stats_bat_summary</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">player_stats_bowl_summary</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>\
                                                <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">player_stats_field_summary</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>

<span class="n">player_stats_summary</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Player</th>
      <th>average_runs_x</th>
      <th>max_runs_x</th>
      <th>min_runs_x</th>
      <th>average_strike_rate</th>
      <th>max_strike_rate</th>
      <th>min_strike_rate</th>
      <th>average_6s</th>
      <th>max_6s</th>
      <th>min_6s</th>
      <th>...</th>
      <th>min_ct</th>
      <th>average_st</th>
      <th>max_st</th>
      <th>min_st</th>
      <th>average_ct_wk</th>
      <th>max_ct_wk</th>
      <th>min_ct_wk</th>
      <th>average_md</th>
      <th>max_md</th>
      <th>min_md</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A Mishra</td>
      <td>10.0</td>
      <td>10</td>
      <td>10</td>
      <td>33.33</td>
      <td>33.33</td>
      <td>33.33</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AB de Villiers</td>
      <td>879.0</td>
      <td>879</td>
      <td>879</td>
      <td>114.45</td>
      <td>114.45</td>
      <td>114.45</td>
      <td>14.0</td>
      <td>14</td>
      <td>14</td>
      <td>...</td>
      <td>8</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AD Hales</td>
      <td>126.0</td>
      <td>126</td>
      <td>126</td>
      <td>70.39</td>
      <td>70.39</td>
      <td>70.39</td>
      <td>1.0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AF Milne</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>&lt;NA&gt;</td>
      <td>...</td>
      <td>4</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AJ Finch</td>
      <td>790.0</td>
      <td>790</td>
      <td>790</td>
      <td>84.04</td>
      <td>84.04</td>
      <td>84.04</td>
      <td>13.0</td>
      <td>13</td>
      <td>13</td>
      <td>...</td>
      <td>6</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 49 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">player_stats_summary</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Player                   0
average_runs_x          11
max_runs_x              11
min_runs_x              11
average_strike_rate     11
max_strike_rate         11
min_strike_rate         11
average_6s              11
max_6s                  11
min_6s                  11
average_4s              11
max_4s                  11
min_4s                  11
average_0s              11
max_0s                  11
min_0s                  11
average_runs_y          53
max_runs_y              53
min_runs_y              53
average_wickets         53
max_wickets             53
min_wickets             53
average_eco             54
max_eco                 54
min_eco                 54
average_sr              75
max_sr                  75
min_sr                  75
average_4w              53
max_4w                  53
min_4w                  53
average_5w              53
max_5w                  53
min_5w                  53
average_dis              1
max_dis                  1
min_dis                  1
average_ct               1
max_ct                   1
min_ct                   1
average_st               1
max_st                   1
min_st                   1
average_ct_wk            1
max_ct_wk                1
min_ct_wk                1
average_md             150
max_md                 150
min_md                 150
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">player_stats_summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>192
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">champions_trophy_2025_squads</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Bangladesh&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Najmul Hossain Shanto (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nasum Ahmed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Taskin Ahmed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Jaker Ali (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Parvez Hossain Emon&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tanzid Hasan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rishad Hossain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Towhid Hridoy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mahmudullah&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mehidy Hasan Miraz&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mushfiqur Rahim (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mustafizur Rahman&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nahid Rana&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tanzim Hasan Sakib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Soumya Sarkar&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;India&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Rohit Sharma (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Shubman Gill (vc)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Jasprit Bumrah&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Shreyas Iyer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ravindra Jadeja&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Yashasvi Jaiswal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Virat Kohli&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Hardik Pandya&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rishabh Pant (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Axar Patel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;KL Rahul (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mohammed Shami&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Arshdeep Singh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Washington Sundar&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kuldeep Yadav&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;New Zealand&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Mitchell Santner (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Michael Bracewell&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mark Chapman&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Devon Conway (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Lockie Ferguson&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Matt Henry&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tom Latham (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Daryl Mitchell&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Glenn Phillips&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rachin Ravindra&quot;</span><span class="p">,</span>
        <span class="s2">&quot;William O&#39;Rourke&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ben Sears&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nathan Smith&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kane Williamson&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Will Young&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Pakistan&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Mohammad Rizwan (c, wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Salman Ali Agha (vc)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Shaheen Afridi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Abrar Ahmed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Faheem Ashraf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Babar Azam&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kamran Ghulam&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mohammad Hasnain&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Usman Khan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Haris Rauf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Khushdil Shah&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Naseem Shah&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Saud Shakeel&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tayyab Tahir&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Fakhar Zaman&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Australia&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Pat Cummins (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Alex Carey (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Travis Head&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Marnus Labuschagne&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Glenn Maxwell&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mitchell Marsh&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Marcus Stoinis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Adam Zampa&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Josh Hazlewood&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mitchell Starc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;David Warner&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Steve Smith&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Cameron Green&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Nathan Ellis&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Aaron Hardie&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;England&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Jos Buttler (c, wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Moeen Ali&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Jonny Bairstow (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Harry Brook&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sam Curran&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ben Duckett&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Liam Livingstone&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dawid Malan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Adil Rashid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Joe Root&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Jason Roy&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Phil Salt (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Chris Woakes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mark Wood&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Reece Topley&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;South Africa&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Temba Bavuma (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Quinton de Kock (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Aiden Markram&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rassie van der Dussen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;David Miller&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Heinrich Klaasen (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Marco Jansen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Kagiso Rabada&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Anrich Nortje&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Lungi Ngidi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Keshav Maharaj&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Tabraiz Shamsi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Reeza Hendricks&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Andile Phehlukwayo&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Dwaine Pretorius&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;Afghanistan&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Hashmatullah Shahidi (c)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rahmanullah Gurbaz (wk)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Ibrahim Zadran&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rashid Khan&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mohammad Nabi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Najibullah Zadran&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Azmatullah Omarzai&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Mujeeb Ur Rahman&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Fazalhaq Farooqi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Naveen-ul-Haq&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Gulbadin Naib&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Rahmat Shah&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Karim Janat&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Sharafuddin Ashraf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Hazratullah Zazai&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gamethon 2025</p>
      </div>
    </a>
    <a class="right-next"
       href="data-analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">FIFS Sports Big Data Gamethon 2025</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Webscrapping ESPNcricinfo</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#espncricinfo-query">ESPNcricinfo query</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#query-structure">Query structure</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fetching-data-from-espncricinfo">Fetching data from ESPNcricinfo</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#documentation-for-scraping-player-data">Documentation for Scraping Player Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modules-used">Modules Used</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constants">Constants</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#process-overview">Process Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#batsmen">Batsmen</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bowlers">Bowlers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fielders">Fielders</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-overview">Data overview</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aditya Godse
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>